<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.academy.manage">

	<!-- 전체리스트출력 -->
	<select id="list" resultType="ManageDTO">
		select *
		from smanagelist
		where cdel
		= 0
		order by smid asc;

	</select>


	<!--정보들어가기 -->
	<select id="readlist" parameterType="java.lang.Integer"
		resultType="ManageDTO">
		select *
		from smanagelist
		where smid = #{smid}

	</select>

	<!--정보등록 -->
	<insert id="register" parameterType="ManageDTO">
		insert into
		smanagelist(ssub, sid, sname, sphone, semail, cdel)
		values(#{ssub},#{sid},#{sname},#{sphone},#{semail},0)
	</insert>

	<!--정보수정 -->
	<update id="update" parameterType="ManageDTO">
		update smanagelist
		set
		ssub =
		#{ssub} , sid= #{sid}, sname= #{sname} , sphone= #{sphone}, semail=
		#{semail}
		where smid = #{smid}
	</update>

	<!--정보삭제 -->
	<delete id="delete" parameterType="java.lang.Integer">
		delete from smanagelist
		where
		smid = #{smid}
	</delete>

	<!-- 검색 -->

	<select id="selectTest" resultType="ManageDTO">
		select *
		from
		smanagelist
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if
				test="searchType=='testTitle' and keyword != null and keyword != '' ">
				AND testTitle like CONCAT('%', #{keyword}, '%')
			</if>
			<if
				test="searchType=='testContent' and keyword != null and keyword != '' ">
				AND testContent like CONCAT('%', #{keyword}, '%')
			</if>
			<if
				test="searchType=='testName' and keyword != null and keyword != '' ">
				AND testName like CONCAT('%', #{keyword}, '%')
			</if>
		</trim>
		ORDER BY
		smid DESC
		LIMIT #{startList}, #{listSize}
	</select>

	<select id="getBoardListCnt" resultType="int">
		select
		count(*) as listCnt
		from
		smanagelist
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="keyword != null and keyword != '' ">
				<if test="searchType=='testTitle'">
					AND testTitle like CONCAT('%', #{keyword}, '%')
				</if>
				<if test="searchType=='testContent'">
					AND testContent like CONCAT('%', #{keyword}, '%')
				</if>
				<if test="searchType=='testName'">
					AND testName like CONCAT('%', #{keyword}, '%')
				</if>
			</if>
		</trim>

	</select>



</mapper>